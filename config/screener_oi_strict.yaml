# config/screener_oi_strict.yaml
# ------------------------------------------------------------
# scr_oi_binance — Open Interest screener (Binance)
# ПРОФИЛЬ: "STRICT (REALISTIC)"
#
# Жёстче, чем balanced:
#  - база тише (но не настолько, чтобы base_ok стал 18/358)
#  - OI/OI$ и объёмы требуем выше
#  - BUY funding строго отрицательный и требуется ухудшение (decreasing=true)
# ------------------------------------------------------------

restart_interval_minutes: 5

screeners:
  - name: scr_oi_binance
    enabled: true
    version: "0.2-strict"

    params:
      exchange_id: 1
      intervals: ["5m", "15m"]

      min_price: 0.0000001
      max_price: 100000

      max_symbols: 0
      signal_mode: "both"

      base_minutes: 240
      trigger_minutes: 20

      # База строже, но НЕ убийственно
      price_sideways_max_pct: 7.0
      price_downtrend_min_pct: 0.3
      base_volume_max_mult: 5.5

      buy_min_green_candles: 2
      buy_require_last_green: true

      oi_calc_key: "open_interest"
      oi_plot_key: "open_interest_value"

      # BUY funding строгий
      enable_funding: true
      buy_funding_max_pct: -0.0001
      buy_require_funding_decreasing: true

      # SELL funding строгий
      sell_enable_funding: true
      sell_funding_min_pct: 0.0001

      stop_loss_pct: 2.0
      take_profit_pct: 5.0

      max_signal_age_minutes: 30

      plots_enabled: true
      plots_dir: "artifacts/screener_plots"
      plot_lookback_bars: 220
      keep_plots_days: 2

      telegram_send_messages: true
      telegram_send_plots: true
      telegram_silent: false
      telegram_extras_enabled: true
      telegram_max_friends: 5

      debug: true
      debug_top: 10

      per_interval_overrides:
        "5m":
          base_minutes: 240
          trigger_minutes: 20
          max_signal_age_minutes: 20
          plot_lookback_bars: 220

          buy_oi_rise_pct: 2.0
          oi_value_confirm_pct: 2.0
          buy_volume_mult: 2.2
          buy_volume_spike_mult: 4.0
          buy_price_rise_pct: 1.0
          buy_min_green_candles: 2
          buy_require_last_green: true

          sell_oi_drop_one_candle_pct: 2.0
          sell_oi_drop_window_pct: 2.5
          sell_price_drop_last_pct: 1.0
          sell_reversal_from_max_pct: 1.1
          sell_volume_spike_mult: 2.3
          sell_volume_drop_ratio: 0.65

        "15m":
          base_minutes: 480
          trigger_minutes: 60
          max_signal_age_minutes: 60
          plot_lookback_bars: 110

          buy_oi_rise_pct: 1.3
          oi_value_confirm_pct: 1.5
          buy_volume_mult: 1.9
          buy_volume_spike_mult: 3.0
          buy_price_rise_pct: 1.4
          buy_min_green_candles: 2
          buy_require_last_green: true

          sell_oi_drop_one_candle_pct: 2.0
          sell_oi_drop_window_pct: 2.5
          sell_price_drop_last_pct: 1.2
          sell_reversal_from_max_pct: 1.8
          sell_volume_spike_mult: 2.5
          sell_volume_drop_ratio: 0.6
